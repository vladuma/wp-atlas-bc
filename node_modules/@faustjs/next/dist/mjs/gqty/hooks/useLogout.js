import { config as coreConfig } from '@faustjs/core';
// eslint-disable-next-line import/extensions
import { LOGOUT_ENDPOINT_PARTIAL_PATH } from '@faustjs/core/config';
import { isNil } from 'lodash';
import { useState } from 'react';
export function create() {
    return () => {
        const { apiBasePath } = coreConfig();
        if (isNil(apiBasePath)) {
            throw new Error('apiBasePath needs to be defined to use the useLogout hook');
        }
        const [isLoading, setIsLoading] = useState(false);
        const [isLoggedOut, setIsLoggedOut] = useState(undefined);
        /**
         * Callable function to logout the existing user.
         */
        async function logout() {
            setIsLoading(true);
            const res = await fetch(`${apiBasePath}/${LOGOUT_ENDPOINT_PARTIAL_PATH}`, {
                method: 'POST',
            });
            setIsLoading(false);
            if (res.ok) {
                setIsLoggedOut(true);
            }
            else {
                setIsLoggedOut(false);
            }
        }
        return { logout, isLoggedOut, isLoading };
    };
}
